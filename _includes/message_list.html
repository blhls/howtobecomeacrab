{% assign mailbox = page.mailbox | default: "" %}
{% assign section = page.section | default: "all" %}

<div class="list-header">
  {% if page.list_title %}{{ page.list_title }}{% else %}messages{% endif %}
</div>

{% if mailbox == "drafts" %}
  {% assign msgs = site.data.messages.drafts %}
  {% for m in msgs %}
    <a class="msg" href="{{ site.baseurl }}{{ m.url }}">
      <div class="subj">{{ m.subject }}</div>
      <div class="meta">from: {{ m.from }} 路 to: {{ m.to }} 路 {{ m.date }}</div>
    </a>
  {% endfor %}
{% else %}
  {% if section == "all" %}
    {% assign posts = site.posts %}
  {% else %}
    {% assign posts = site.posts | where: "section", section %}
  {% endif %}

  {% for post in posts %}
    <a class="msg" href="{{ site.baseurl }}{{ post.url }}">
      <div class="subj">{{ post.subject | default: post.title }}</div>
      <div class="meta">from: {{ post.from | default: post.section | default: "UNKNOWN" }} 路 to: YOU 路 {{ post.date | date: "%d/%m/%Y" }}</div>
    </a>
  {% endfor %}
{% endif %}
